/* ===== THEME (aprox. Daggerheart) ===== */
:root {
  --dh-bg: #15131b;
  --dh-surface: #1f1b2a;
  --dh-panel: #2b2536;
  --dh-border: #3b3248;
  --dh-text: #f5f5f7;
  --dh-muted: #c9c3d7;
  --dh-accent: #f2c24b;
  --dh-accent-ink: #2b220a;
  --dhud-ring-main: none;
  --dhud-ring-weapon: none;
}

/* Toggled by settings: document.body.classList.toggle('dhud-hide-hotbar', ...) */
body.dhud-hide-hotbar #hotbar { display: none !important; }

.dhud { background-color: var(--dhud-bg); }
.dhud .accent { color: var(--dhud-accent); }

/* ===== Remove window and clipping Application V2 ===== */
.daggerheart-hud.window-app,
.daggerheart-hud.application {
  border: 0 !important;
  box-shadow: none !important;
  background: transparent !important;
  overflow: visible !important;
}
.daggerheart-hud .window-header { display: none !important; }
.daggerheart-hud .window-content {
  background: transparent !important;
  padding: 20px 10px !important;
  overflow: visible !important;
  backdrop-filter: blur(2px);
}
.daggerheart-hud .window-resizable-handle { display: none !important; }

/* ===== Layout shell ===== */
.dhud { color: var(--dh-text); }
.dhud--layout {
  position: relative;
  display: grid;
  grid-template-columns: auto auto auto;
  align-items: center;
  gap: .75rem;
}

/* ===== Wings ===== */
.dhud-wing { position: relative; display: flex; gap: .5rem; align-items: center; }
.dhud-wing--left  { justify-content: flex-end; }
.dhud-wing--right { justify-content: flex-start; }

.dhud-tab {
  position: relative;
  padding: .38rem .9rem;
  font-weight: 800;
  letter-spacing: .06em;
  border: 2px solid var(--dh-border);
  border-radius: 6px;
  background: var(--dh-surface);
  box-shadow: inset 0 -1px 0 rgba(255,255,255,.06);
  cursor: pointer;
  user-select: none;
  text-transform: uppercase;
}
.dhud-tab:hover,
.dhud-tab:active,
.dhud-tab:focus { border-color: var(--dh-accent); }

/* Panels (popover above tab) */
.dhud-tabwrap { position: relative; }
.dhud-panel {
  --panel-w: 320px;
  position: absolute;
  left: 0; right: auto;
  bottom: calc(100% + .5rem);
  width: var(--panel-w);
  background: var(--dh-panel);
  max-height: var(--dhud-panel-maxh, 300px); /* JS can set this per open */
  overflow: auto;
  border: 2px solid var(--dh-border);
  border-radius: 12px;
  padding: .6rem .7rem;
  box-shadow: 0 14px 36px rgba(0,0,0,.5);
  display: none;
  z-index: 500;                /* sobre o app */
}
.dhud-tabwrap--right .dhud-panel { left: auto; right: 0; }
.dhud-panel header {
  font-weight: 900;
  margin-bottom: .5rem;
  margin: 10px 5px;
  padding-bottom: 2px;
  border-bottom: 1px solid var(--dh-accent);
}
/* Vertical direction set by JS on the specific panel */
.dhud-panel[data-open-dir="down"] {
  /* open BELOW the tab header */
  top: calc(100% + .5rem);
  bottom: auto;
  transform-origin: top center;
}

.dhud-panel[data-open-dir="up"] {
  /* (optional explicit UP; matches your default) */
  bottom: calc(100% + .5rem);
  top: auto;
  transform-origin: bottom center;
}


/* Open-state controlado por [data-open] no root */
.dhud[data-open="traits"]    #panel-traits,
.dhud[data-open="ancestry"]  #panel-ancestry,
.dhud[data-open="inventory"] #panel-inventory,
.dhud[data-open="domains"]   #panel-domains,
.dhud[data-open="class"]     #panel-class,
.dhud[data-open="loadout"]   #panel-loadout,
.dhud[data-open="vault"]     #panel-vault { display: block; }

/* ===== Accordion (itens dos painéis) ===== */
.dhud-acc { list-style: none; margin: 0; padding: 0; display: grid; gap: .4rem;  }

/* Keep each accordion row on a single line and push controls to the right */
.dhud-acc summary {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  flex-wrap: nowrap;   
  padding: 4px 8px;
  border: 1px solid var(--dh-border);
  border-radius: 4px;
}

.dhud-acc .icon {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 24px; height: 24px;
  vertical-align: middle;
}

/* Icon stays fixed size */
.dhud-acc summary .icon {
  width: 24px; height: 24px;
  flex: 0 0 auto;
}

.dhud-acc summary .icon.clickable {
  cursor: pointer;
  border: 2px solid var(--dh-pip-border);
}

.dhud-acc summary .icon.clickable:hover {
  cursor: pointer;
  border: 2px solid var(--dh-accent);
}

.dhud-acc summary .icon:not(.clickable) {
  cursor: default;
}



/* Title takes remaining space, truncates with ellipsis if too long */
.dhud-acc summary .title {
  flex: 1 1 auto;
  min-width: 0; 
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.dhud-acc summary .title:hover {
  text-shadow: 0 0 2px var(--dh-pip-border);
}

/* Small chips stay inline and non-wrapping */
.dhud-acc summary .qty,
.dhud-acc summary .recall {
  flex: 0 0 auto;
  white-space: nowrap;
}

/* Action icons on the far right */
.dhud-acc summary .move,
.dhud-acc summary .chat {
  flex: 0 0 auto;
  margin-left: 0.4rem;
}

/* ===== Core (anel central e círculos laterais) ===== */
.dhud-core {
  /* tamanhos principais */
  --circle-d: 110px;
  --side-d: 75px;
  --pip: 16px;

  /* spacing e fórmulas */
  --core-gap: .05rem; 
  --overlap: 8px;   
  --badge-inset: 8px; 

  /* offsets de HP/Stress (ajuste só aqui) */
  --hp-top: -6px;
  --hp-left: 45px;
  --stress-top: -6px;
  --stress-right: 43px;

  display: grid;
  grid-template-columns: var(--side-d) var(--circle-d) var(--side-d);
  align-items: center;
  justify-items: center;
  gap: var(--core-gap);
  position: relative;
}

/* ordem entre wrappers (resolve stacking contexts com transform) */
.dhud-core__leftcircle,
.dhud-core__rightcircle { position: relative; z-index: 1; }
.dhud-core__center      { position: relative; z-index: 2; }  /* ring acima */

/* Side circles with ícone do item */
.dhud-circle {
  width: var(--side-d);
  height: var(--side-d);
  border-radius: 999px;
  display: grid;
  place-items: center;
  position: relative;
  z-index: 1;
  pointer-events: auto;
  /* Remove background-image from here since we're using ::after overlay */
}

.dhud-circle .item-icon {
  position: relative;
  width: 70%;
  height: 70%;
  object-fit: cover;
  filter: drop-shadow(0 1px 2px rgba(0,0,0,.5));
  border: none;
  border-radius: 999px;
  z-index: 2;
  box-shadow: inset 0 1px 6px rgba(0,0,0,0.3);
  transition: box-shadow 0.2s ease;
}

.dhud-circle .item-icon:hover {
  box-shadow: inset 0 2px 8px rgba(0,0,0,0.5);
}

/* Alternative approach: If you want the ring image to be more like a border overlay */
.dhud-circle::after {
  content: '';
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  border-radius: 999px;
  background-image: var(--dhud-ring-weapon, none);
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  pointer-events: none;
  z-index: 3; /* Above the item icon */
}

/* If using the ::after approach, remove the background from the main circle */
.dhud-circle.use-overlay-ring {
  background-image: none;
}


/* ===== DEBUGGING STYLES (temporary) ===== */

/* Add these temporarily to see what's happening */
.dhud-ring {
  /* Temporary border to see the ring boundaries */
  /* border: 2px solid red; */
}

.dhud-circle {
  /* Temporary border to see the weapon circle boundaries */
  /* border: 2px solid blue; */
}

.dhud-portrait {
  /* Temporary border to see the portrait boundaries */
  /* border: 2px solid green; */
}
.dhud-roll { 
  cursor: pointer;
  display: inline-flex;
  align-items: center;
  justify-content: center;
}

/* Specific styling for trait rolls only */
.dhud-action-roll {
  border: 2px solid var(--dh-border);
  border-radius: 4px;
  padding: 4px;
  transition: border-color 0.2s ease;
}

.dhud-action-roll:hover { 
  border-color: var(--dh-accent); 
}

/* Reaction button chip */
.dhud-acc summary .dhud-reaction-btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 22px;
  height: 22px;
  border-radius: 999px;
  border: 1.5px solid var(--dh-accent);
  color: var(--dh-accent);
  background: transparent;
  margin-left: 0.35rem;
  flex: 0 0 auto;
  transition: background 120ms ease, color 120ms ease, opacity 120ms, border-color 120ms ease;
  cursor: pointer;
  opacity: 0.65;
}
.dhud-acc summary .dhud-reaction-btn i {
  font-size: 12px;
  line-height: 1;
  pointer-events: none;
}
.dhud-acc summary .dhud-reaction-btn:hover,
.dhud-acc summary .dhud-reaction-btn:focus-visible {
  background: var(--dh-accent);
  border-color: var(--dh-accent);
  color: var(--dh-surface);
  outline: none;
  opacity: 1;
}

/* aproximação dos círculos laterais */
.dhud-core__leftcircle  { transform: translateX(var(--overlap)); }
.dhud-core__rightcircle { transform: translateX(calc(-1 * var(--overlap))); }

/* Anel central */
.dhud-core__center {

  pointer-events: none;

  display: grid;
  grid-template-areas:
    "ring"
    "th";
  align-items: center;
  justify-items: center;
  row-gap: .25rem;
}

/* Main ring - portrait container */
.dhud-ring {
  grid-area: ring;
  position: relative;
  width: var(--circle-d);
  height: var(--circle-d);
  border-radius: 999px;
  display: grid;
  place-items: center;

  /* Ring frame art as background */
  background-image: var(--dhud-ring-main, none);
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;

  z-index: 1;
  pointer-events: auto;
  cursor: grab;
}
.dhud-ring:active { cursor: grabbing; }

.dhud-ring img {border: none; }

.dhud-ring-overlay {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  border-radius: 999px;
  background-image: var(--dhud-ring-main, none);
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  pointer-events: none;
  z-index: 2; /* Above portrait */
}

.dhud-ring {
  background-image: none; /* Remove from main ring */
}

.dhud-portrait {
  position: relative;
  width: calc(var(--circle-d) - 20px); /* Slightly smaller to prevent cutoff */
  height: calc(var(--circle-d) - 20px);
  border-radius: 999px; 
  overflow: hidden;
  pointer-events: auto; 
  z-index: 1;
}

.dhud-portrait-img {
  box-shadow: 0 0 5px 2px #000;
}

.dhud-death {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 70px; 
  height: 70px;
  background-image: url("/modules/daggerheart-hud/ui/death.svg");
  background-repeat: no-repeat;
  background-position: center;
  background-size: 80% 80%;
  cursor: pointer;
  z-index: 10; /* Above portrait but below overlay if needed */
}

.dhud-death:hover {
    filter: drop-shadow(0 1px 3px rgba(255, 255, 255));
}

.dhud--dying .dhud-portrait img,
.dhud--dying .dhud-circle img,
.dhud--dying .dhud-circle,
.dhud--dying .dhud-ring,
.dhud--dying .dhud-thresholds .chip,
.dhud--dying .dhud-badge--right .dhud-armor-max {
  filter: saturate(0.3) brightness(0.95);
}

.dhud-circle .item-icon {
  position: relative;
  width: 70%;
  height: 70%;
  object-fit: cover;
  /* filter: drop-shadow(0 1px 2px rgba(0,0,0,.5)); */
  border: none;
  border-radius: 999px;
  z-index: 2;
  box-shadow: 0 0 3px 1px #000;
  transition: box-shadow 0.2s ease;
}

.dhud-circle .item-icon:hover {
  box-shadow: 0 0 6px 2px var(--dh-accent);
}
/* Hope pips */
.dhud-pips {
  position: absolute;
  top: -14px;
  left: 50%;
  transform: translateX(-50%);
  display: flex;
  flex-direction: row;
  align-items: center;
  justify-content: space-around;
  gap: 5px;
  z-index: 3;
}

.dhud-pips .pip {
  width: var(--pip);
  height: var(--pip);
  border: 2px solid var(--dh-pip-border);
  background: transparent;
  transition: background .15s, border-color .15s, transform .15s;
}

.dhud-pips .pip:hover {
  transform: scale(1.15);
  border: 3px solid var(--dh-pip-border);
}

/* Empty pips = circles */
.dhud-pips .pip {
  border-radius: 999px;
}

/* Filled pips = diamonds */
.dhud-pips .pip.filled {
  background: var(--dh-accent);
  border-color: var(--dh-pip-border);
  opacity: 1;
  border-radius: 2px;
  transform: rotate(45deg);
  width: calc(var(--pip) - 3px);
  height: calc(var(--pip) - 3px);
  }


.dhud-count .value,
.dhud-pips .pip {
  cursor: pointer;
  user-select: none;
}
/* .dhud-pips .pip { display:inline-block; width:10px; height:10px; border-radius:50%; } */


/* HP / Stress (absolutos; clicáveis para futuros +/-) */
.dhud-count {
  position: absolute;
  white-space: nowrap;
  text-align: center;
  pointer-events: auto;
  font-size: 16px ;
}
.dhud-count--hp {
  top: var(--hp-top);
  left: var(--hp-left);
  text-align: center;
}
.dhud-count--stress {
  top: var(--stress-top);
  right: var(--stress-right);
  text-align: center;
}
.dhud-count--hp .value:hover,
.dhud-count--stress .value:hover{
  font-weight: 700;
  text-shadow: 0px 0px 3px var(--dh-pip-border);
}
.dhud-count--hp i,
.dhud-count--stress i {
  filter: drop-shadow(0px 0px 1px var(--dh-accent));
}

/* Thresholds:  */
.dhud-thresholds {
  grid-area: th;
  grid-column: 1 / -1;
  display: flex;
  justify-content: center;
  align-items: center;
  gap: .5rem;
  margin-top: .25rem;
  pointer-events: none;
}
.dhud-thresholds .chip {
  background: var(--dh-surface);
  color: var(--dh-accent);
  padding: .14rem .6rem;
  border-radius: 8px;
  font-weight: 900;
  letter-spacing: .04em;
  text-transform: uppercase;
}
.dhud-thresholds .val {
  padding: .1rem .45rem;
  border: 1px solid var(--dh-border);
  border-radius: 8px;
  background: var(--dh-surface);
  color: var(--dh-text);
  font-weight: 800;
  min-width: 2.2ch;
  text-align: center;
}

/* Badges  */
.dhud-badge {
  position: absolute;
  top: 50%;
  transform: translateY(0%);
  z-index: 3;
  display: grid; place-items: center;
  font-weight: 800; font-size: .95rem;
  font-variant-numeric: tabular-nums;
  
}

.dhud-badge--left {
  width: 30px; height: 40px;
  left: calc(var(--side-d) + var(--core-gap) - 20px + var(--badge-inset));
  background-image: url("/modules/daggerheart-hud/ui/shield.svg");
  background-repeat: no-repeat;
  background-position: center;
  background-size: contain;
}
.dhud-badge--right {
  width: 40px; height: 40px;
  left: calc(var(--side-d) + var(--core-gap) + var(--circle-d) - 20px - var(--badge-inset));
  background-image: url("/modules/daggerheart-hud/ui/armor.svg");
  background-repeat: no-repeat;
  background-position: center;
  background-size: auto;
  cursor: pointer;
}

.dhud-badge--right:hover {
  font-weight: 700;
  text-shadow: 0px 0px 3px var(--dh-pip-border);
}

.dhud-armor{
  /* scales relative to the icon; tweak 0.9→1.0 to taste */
  display: flex;
  flex-direction: column;
  align-items: center;
  font-size: 1em;
  line-height: 1;
  letter-spacing: -0.05em;
}

.dhud-badge--right .dhud-armor-max{
  position: absolute;
  display:flex ;
  align-items: center;
  justify-content: center;
  right: -3px;               
  bottom: -3px;            
  z-index: 4;
  pointer-events: none;     
  /* pill sizing & typography */
  width: 20px;
  height: 20px;
  border: 2px solid var(--dh-accent);
  border-radius: 50%;
  font-size: 0.75em;
  font-weight: 700;
  font-variant-numeric: tabular-nums;
  background: var(--dh-surface);
}

/* ---- Wings open/close animation ---- */
.dhud--layout {
  --wing-shift: 28px;                       /* slide distance */
  --wing-duration: 220ms;
  --wing-ease: cubic-bezier(.2,.8,.2,1);
}

/* transition for both wings */
.dhud-wing {
  transition:
    transform var(--wing-duration) var(--wing-ease),
    opacity   var(--wing-duration) var(--wing-ease);
  will-change: transform, opacity;
}

/* Hide any open panel while wings are retracted */
.dhud--layout[data-wings="closed"] .dhud-panel {
  display: none !important;
}

/* Default state = CLOSED (you'll set it via JS on first render) */
.dhud--layout[data-wings="closed"] { grid-template-columns: 0 auto 0; }
.dhud--layout[data-wings="closed"] .dhud-wing--left  { opacity:0; transform:translateX(-28px); pointer-events:none; }
.dhud--layout[data-wings="closed"] .dhud-wing--right { opacity:0; transform:translateX( 28px); pointer-events:none; }
.dhud--layout[data-wings="open"] .dhud-wing { opacity:1; transform:none; pointer-events:auto; }

/* Make sure stacking order is: wings > core */
.dhud--layout { position: relative; }

.dhud-core  { position: relative; z-index: 10; }
.dhud-wing  { position: relative; z-index: 30; }  /* wings above core */
.dhud-panel { position: absolute; z-index: 40; }  /* panels above everything in the HUD */

.capitalize { text-transform: capitalize; }


/* HUD Theme Config — 2-up cards with theme support */
#dh-hud-images-config .window-content { overflow: auto;}

.dh-hudrings { padding: 12px; }

.dh-hudrings .cards {
  display: grid;
  grid-template-columns: 1fr 1fr; /* 2 cards per row */
  gap: 16px;
}

/* Card shell with theme support */
.dh-hudrings .card {
  border: 1px solid var(--dh-border, rgba(255,255,255,0.15));
  border-radius: 10px;
  background: var(--dh-surface, rgba(255,255,255,0.03));
  padding: 12px;
  display: flex;
  flex-direction: column;
  gap: 12px;
}

/* Card header */
.dh-hudrings .card-head {
  display: grid;
  grid-template-columns: 1fr auto;
  align-items: center;
  gap: 12px;
}
.dh-hudrings .who {
  text-align: center;
}
.dh-hudrings .who .char {
  font-weight: 700;
  font-size: 16px;
  line-height: 1.2;
  color: var(--dh-accent, #fff);
}
.dh-hudrings .who .player {
  opacity: .8;
  font-size: 12px;
}
.dh-hudrings .scheme {
  display: flex;
  align-items: center;
  gap: 8px;
  justify-content: center;
}
.dh-hudrings .scheme label { 
  white-space: nowrap; 
  color: var(--dh-accent, #fff);
  font-weight: 600;
}
.dh-hudrings .scheme select.dh-color { 
  min-width: 170px;
  background: var(--dh-surface, #15161a);
  border: 1px solid var(--dh-border, rgba(255, 255, 255, 0.12));
  color: #fff;
  border-radius: 4px;
  padding: 0.5rem;
}
.dh-hudrings .scheme select.dh-color:focus {
  border-color: var(--dh-accent, #f2c24b);
  outline: none;
  box-shadow: 0 0 0 2px rgba(242, 194, 75, 0.3);
}

/* Previews row (portrait | weapons) */
.dh-hudrings .previews {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 12px;
}
.dh-hudrings .preview-card {
  display: grid;
  grid-template-rows: auto auto auto;
  gap: 8px;
}
.dh-hudrings .preview-card .title {
  font-weight: 600;
  text-align: left;
  opacity: .9;
  color: var(--dh-accent, #fff);
}

/* Preview box with click-to-pick and placeholder */
.dh-hudrings .preview-box {
  position: relative;
  display: flex; align-items: center; justify-content: center;
  width: 100%; height: 120px;
  border: 1px dashed var(--dh-border, rgba(255,255,255,0.2));
  border-radius: 10px;
  background: var(--dh-surface, rgba(255,255,255,0.03));
  overflow: hidden;
  cursor: pointer;
}
.dh-hudrings .preview-box:hover {
  outline: 2px solid var(--dh-accent, rgba(255,255,255,0.25));
}
.dh-hudrings .preview-box img.preview {
  max-width: 100%; max-height: 100%; display: block;
}

/* "Search" placeholder */
.dh-hudrings .preview-box .placeholder {
  position: absolute; inset: 0;
  display: flex; align-items: center; justify-content: center;
  font-style: italic; font-size: 0.95rem; opacity: 0.75; pointer-events: none;
}
.dh-hudrings .preview-box img.preview[src=""],
.dh-hudrings .preview-box img.preview:not([src]) { display: none; }
.dh-hudrings .preview-box img.preview[src]:not([src=""]) ~ .placeholder { display: none; }

/* Path row under each preview */
.dh-hudrings .path-row {
  display: grid;
  grid-template-columns: 1fr auto;
  gap: 8px;
}
.dh-hudrings .path-row input.path { 
  min-width: 0;
  background: var(--dh-surface, #15161a);
  border: 1px solid var(--dh-border, rgba(255, 255, 255, 0.12));
  color: #fff;
  border-radius: 4px;
  padding: 0.5rem;
}
.dh-hudrings .path-row input.path:focus {
  border-color: var(--dh-accent, #f2c24b);
  outline: none;
  box-shadow: 0 0 0 2px rgba(242, 194, 75, 0.3);
}
.dh-hudrings .path-row .clear-path {
  width: 34px; height: 34px;
  border: 1px solid var(--dh-border, rgba(255,255,255,0.2));
  border-radius: 6px;
  background: var(--dh-surface, rgba(255,255,255,0.06));
  line-height: 1; font-weight: 700;
  color: var(--dh-accent, #f2c24b);
  cursor: pointer;
}
.dh-hudrings .path-row .clear-path:hover {
  background: var(--dh-accent, #f2c24b);
  color: var(--dh-surface, #15161a);
}

/* Footer */
.dh-hudrings .empty { margin: 8px 0; text-align: center; opacity: .8; }
.dh-hudrings-footer {
  display: flex; justify-content: space-around; align-items: center; gap: 10px; margin-top: 20px;
}
.dh-hudrings-footer button {
  width: 90%; 
  padding: 20px; 
  background-color: var(--dh-surface, #15161a);
  border: 1px solid var(--dh-border, rgba(255, 255, 255, 0.12));
  color: var(--dh-accent, #f2c24b);
  border-radius: 6px;
  font-weight: 600;
  cursor: pointer;
}
.dh-hudrings-footer button:hover {
  background-color: var(--dh-accent, #f2c24b);
  color: var(--dh-surface, #15161a);
}

.dhud {
  /* Ensure wings are closed by default */
}

.dhud:not([data-wings="open"]) .dhud-wing--left,
.dhud:not([data-wings="open"]) .dhud-wing--right {
  /* Force wings to be hidden when not explicitly open */
  display: none;
  opacity: 0;
  pointer-events: none;
  transform: scale(0.8);
  transition: opacity 0.2s ease, transform 0.2s ease;
}

.dhud[data-wings="open"] .dhud-wing--left,
.dhud[data-wings="open"] .dhud-wing--right {
  /* Wings visible when open */
  display: flex;
  opacity: 1;
  pointer-events: auto;
  transform: scale(1);
  transition: opacity 0.2s ease, transform 0.2s ease;
}

/* Alternatively, if you want them completely hidden: */
.dhud[data-wings="closed"] .dhud-wing--left,
.dhud[data-wings="closed"] .dhud-wing--right {
  display: none;
}

/* ===== STATUS CONTEXT MENU & GRID ===== */

/* Context Menu */
.dhud-context-menu {
  position: absolute;
  background: var(--dh-panel);
  border: 2px solid var(--dh-border);
  border-radius: 8px;
  padding: 8px 0;
  box-shadow: 0 8px 24px rgba(0,0,0,0.5);
  z-index: 1000;
  min-width: 180px;
  display: none;
  opacity: .85;
}

.dhud-context-menu.show {
  display: block;
}

.dhud-context-item {
  padding: 8px 16px;
  display: flex;
  align-items: center;
  gap: 8px;
  cursor: pointer;
  color: var(--dh-text);
  font-size: 14px;
  transition: background-color 0.15s;
}

.dhud-context-item:hover {
  background: var(--dh-border);
}

.dhud-context-item i {
  width: 16px;
  text-align: center;
  color: var(--dh-accent);
}

/* Status Effects Grid */
.dhud-status-grid {
  position: absolute;
  background: var(--dh-surface);
  border: 2px solid var(--dh-border);
  border-radius: 8px;
  padding: 12px;
  box-shadow: 0 8px 24px rgba(0,0,0,0.5);
  z-index: 1000;
  width: 320px;
  max-height: 400px;
  overflow-y: auto;
  display: none;
}

.dhud-status-grid.show {
  display: block;
}

.dhud-status-header {
  color: var(--dh-accent);
  font-weight: bold;
  margin-bottom: 12px;
  padding-bottom: 8px;
  border-bottom: 1px solid var(--dh-border);
  display: flex;
  align-items: center;
  gap: 8px;
}

.dhud-status-section {
  margin-bottom: 16px;
}

.dhud-status-section-title {
  color: var(--dh-muted);
  font-size: 12px;
  font-weight: 600;
  text-transform: uppercase;
  margin-bottom: 8px;
  letter-spacing: 0.5px;
}

.dhud-status-icons {
  display: grid;
  grid-template-columns: repeat(8, 1fr);
  gap: 4px;
}

.dhud-status-icon {
  width: 32px;
  height: 32px;
  border: 1px solid var(--dh-border);
  border-radius: 4px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.15s;
  position: relative;
  background: var(--dh-surface);
}

.dhud-status-icon:hover {
  border-color: var(--dh-accent);
  transform: scale(1.1);
  box-shadow: 0 2px 8px rgba(0,0,0,0.3);
}

.dhud-status-icon.active {
  border-color: var(--dh-accent);
  background: var(--dh-accent);
  color: var(--dh-accent-ink);
}

.dhud-status-icon img {
  width: 24px;
  height: 24px;
  object-fit: contain;
}

/* .dhud-status-icon.active::after {
  content: '✓';
  position: absolute;
  top: -4px;
  right: -4px;
  background: var(--dh-accent);
  color: var(--dh-accent-ink);
  border-radius: 50%;
  width: 14px;
  height: 14px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 10px;
  font-weight: bold;
} */

/* Tooltip */
.dhud-tooltip {
  position: absolute;
  background: var(--dh-bg);
  color: var(--dh-text);
  padding: 4px 8px;
  border-radius: 4px;
  font-size: 12px;
  pointer-events: none;
  z-index: 1001;
  white-space: nowrap;
  opacity: 0;
  transition: opacity 0.2s;
}

.dhud-tooltip.show {
  opacity: 1;
}

/* GM Override Section - New Classes Only */
.gm-override-section {
  margin-bottom: 16px;
  padding: 12px;
  border: 2px solid var(--dh-border);
  border-radius: 10px;
  background: var(--dh-surface);
}

.gm-override-header {
  display: flex;
  align-items: center;
  gap: 8px;
  font-weight: 700;
  color: var(--dh-accent);
  cursor: pointer;
  margin-bottom: 12px;
  padding: 8px;
  border-radius: 6px;
}

.gm-override-header:hover {
  background: var(--dh-border);
}

.gm-override-checkbox {
  width: 18px;
  height: 18px;
  margin: 0;
  cursor: pointer;
  accent-color: var(--dh-accent);
}

.gm-override-controls {
  padding-top: 12px;
  border-top: 1px solid var(--dh-border);
  margin-top: 12px;
}

.gm-override-controls .preview-card .title {
  color: var(--dh-accent);
  font-weight: 600;
}

.gm-override-controls .path {
  background: var(--dh-surface);
  border: 1px solid var(--dh-border);
  color: var(--dh-text);
  border-radius: 4px;
  padding: 0.5rem;
}

.gm-override-controls .path:focus {
  border-color: var(--dh-accent);
  outline: none;
}

.gm-override-controls .clear-path {
  width: 34px;
  height: 34px;
  border: 1px solid var(--dh-border);
  border-radius: 6px;
  background: var(--dh-surface);
  color: var(--dh-accent);
  cursor: pointer;
  font-weight: 700;
}

.gm-override-controls .clear-path:hover {
  background: var(--dh-accent);
  color: var(--dh-surface);
}

.gm-theme-section {
  margin-bottom: 12px;
  padding: 12px;
  border: 1px solid var(--dh-border);
  border-radius: 6px;
  background: var(--dh-surface);
}

.gm-theme-label {
  display: block;
  color: var(--dh-accent);
  font-weight: 600;
  margin-bottom: 8px;
}

.gm-theme-select {
  width: 100%;
  background: var(--dh-surface);
  border: 1px solid var(--dh-border);
  color: var(--dh-text);
  border-radius: 4px;
  padding: 0.5rem;
}

.gm-theme-select:focus {
  border-color: var(--dh-accent);
  outline: none;
}


/* ===== Responsivo ===== */
@media (max-width: 980px) {
  /* opcional: reduza levemente em telas menores */
  .dhud-core { --circle-d: 100px; --side-d: 68px; }
  .dhud-panel { --panel-w: 280px; }
}
